version: 2

models:
  - name: int_orders__joined
    description: >
      Enriched order facts with customer and store context.
      One row per order with denormalized attributes for downstream consumption.
      This is a foundational model used across multiple marts.
    columns:
      - name: order_id
        description: Unique identifier for each order (primary key)
        data_tests:
          - unique
          - not_null

      - name: customer_id
        description: Foreign key to customers
        data_tests:
          - not_null

      - name: store_id
        description: Foreign key to stores
        data_tests:
          - not_null

      - name: ordered_at
        description: Timestamp when the order was placed
        data_tests:
          - not_null

      - name: subtotal
        description: Order subtotal in dollars (before tax)

      - name: tax_paid
        description: Tax amount in dollars

      - name: order_total
        description: Total order amount in dollars

      - name: store_name
        description: Name of the store where order was placed

      - name: store_tax_rate
        description: Tax rate for the store location

      - name: store_opened_at
        description: Date when the store opened

      - name: customer_name
        description: Name of the customer who placed the order

      - name: days_since_store_opened
        description: Number of days between store opening and order date

      - name: is_first_order
        description: Boolean flag indicating if this is the customer's first order
        data_tests:
          - not_null

      - name: order_date
        description: Date portion of ordered_at (for aggregations)

      - name: order_month
        description: Month (first day) of when order was placed

      - name: order_quarter
        description: Quarter (first day) of when order was placed

      - name: order_year
        description: Year when order was placed

  - name: int_order_items__joined
    description: >
      Order line items enriched with product and order context.
      One row per item purchased, with product details and order information.
    columns:
      - name: order_item_id
        description: Unique identifier for each order item (primary key)
        data_tests:
          - unique
          - not_null

      - name: order_id
        description: Foreign key to orders
        data_tests:
          - not_null

      - name: sku
        description: Product SKU code
        data_tests:
          - not_null

      - name: product_name
        description: Name of the product purchased

      - name: product_type
        description: Product category (Jaffle or Beverage)

      - name: price
        description: Product price in dollars

      - name: customer_id
        description: Customer who purchased this item
        data_tests:
          - not_null

      - name: store_id
        description: Store where this item was purchased
        data_tests:
          - not_null

      - name: ordered_at
        description: Timestamp when this item was ordered
        data_tests:
          - not_null

      - name: item_revenue
        description: Revenue from this item (equals product price)

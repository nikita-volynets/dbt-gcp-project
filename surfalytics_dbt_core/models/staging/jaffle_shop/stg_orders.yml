version: 2

models:
  - name: stg_orders
    description: >
      Staging model for order fact table.
      One row per order with customer, store, and financial details.
      Monetary values have been converted from cents to dollars.
    columns:
      - name: order_id
        description: Unique identifier for each order (primary key)
        data_tests:
          - unique
          - not_null

      - name: customer_id
        description: Foreign key to customers
        data_tests:
          - not_null
          - relationships:
              to: ref('stg_customers')
              field: customer_id

      - name: store_id
        description: Foreign key to stores
        data_tests:
          - not_null
          - relationships:
              to: ref('stg_stores')
              field: store_id

      - name: ordered_at
        description: Timestamp when the order was placed
        data_tests:
          - not_null

      - name: subtotal
        description: Order subtotal in dollars (before tax)
        data_tests:
          - not_null

      - name: tax_paid
        description: Tax amount in dollars
        data_tests:
          - not_null

      - name: order_total
        description: Total order amount in dollars (subtotal + tax)
        data_tests:
          - not_null

      - name: tax_rate
        description: Calculated tax rate (tax_paid / subtotal) for validation

      - name: _loaded_at
        description: Timestamp when this record was loaded into staging

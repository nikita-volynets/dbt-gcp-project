version: 2

sources:
  - name: jaffle_shop
    description: Raw Jaffle Shop e-commerce data loaded via dbt seeds
    database: "{{ env_var('DBT_PROJECT') }}"
    schema: "{{ target.schema }}_raw_jaffle_shop"

    tables:
      - name: raw_customers
        description: Customer dimension data with basic profile information
        columns:
          - name: id
            description: Unique identifier for each customer (UUID)
          - name: name
            description: Customer full name

      - name: raw_orders
        description: Order fact table containing all customer orders
        columns:
          - name: id
            description: Unique identifier for each order (UUID)
          - name: customer
            description: Foreign key to customers table
          - name: ordered_at
            description: Timestamp when the order was placed
          - name: store_id
            description: Foreign key to stores table
          - name: subtotal
            description: Order subtotal in cents (before tax)
          - name: tax_paid
            description: Tax amount in cents
          - name: order_total
            description: Total order amount in cents (subtotal + tax)

      - name: raw_items
        description: Order line items showing products purchased in each order
        columns:
          - name: id
            description: Unique identifier for each order item (UUID)
          - name: order_id
            description: Foreign key to orders table
          - name: sku
            description: Foreign key to products table (product SKU)

      - name: raw_products
        description: Product catalog with pricing and descriptions
        columns:
          - name: sku
            description: Stock keeping unit - unique product identifier
          - name: name
            description: Product name
          - name: type
            description: Product category (Jaffle or Beverage)
          - name: price
            description: Product price in cents
          - name: description
            description: Product description

      - name: raw_stores
        description: Store location dimension data
        columns:
          - name: id
            description: Unique identifier for each store (UUID)
          - name: name
            description: Store location name
          - name: opened_at
            description: Timestamp when the store opened
          - name: tax_rate
            description: Sales tax rate for this store location

      - name: raw_supplies
        description: Bill of materials mapping supplies to products
        columns:
          - name: id
            description: Supply item identifier
          - name: name
            description: Supply item name
          - name: cost
            description: Cost of this supply item in cents
          - name: perishable
            description: Boolean flag indicating if supply is perishable
          - name: sku
            description: Foreign key to products table

    freshness:
      warn_after: {count: 1, period: day}
